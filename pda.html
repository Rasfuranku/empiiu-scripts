<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruta Saneamiento y Estructura Financiera - Monta帽aM铆a</title>

    <!-- React y ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel para traducir JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .perspective-1000 {
            perspective: 1000px;
        }

        .transform-style-3d {
            transform-style: preserve-3d;
        }

        .backface-hidden {
            backface-visibility: hidden;
        }

        .rotate-y-180 {
            transform: rotateY(180deg);
        }

        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        @keyframes bounce-short {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-5px);
            }
        }

        .animate-bounce-short {
            animation: bounce-short 1s infinite;
        }

        /* Estilos para enlaces dentro de las tarjetas */
        .card-link {
            color: #2563eb;
            text-decoration: underline;
            font-weight: 600;
        }

        .card-link:hover {
            color: #1e40af;
        }
    </style>
</head>

<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- CONOS SVG ---
        const Icons = {
            Wallet: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4" /><path d="M3 5v14a2 2 0 0 0 2 2h16v-5" /><path d="M18 12a2 2 0 0 0 0 4h4v-4Z" /></svg>,
            User: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2" /><circle cx="12" cy="7" r="4" /></svg>,
            Tag: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z" /><path d="M7 7h.01" /></svg>,
            Home: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" /><polyline points="9 22 9 12 15 12 15 22" /></svg>,
            Package: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m7.5 4.27 9 5.15" /><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z" /><path d="m3.27 6.96 8.73 5.05 8.73-5.05" /><path d="M12 22.08V12" /></svg>,
            ClipboardList: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="8" height="4" x="8" y="2" rx="1" ry="1" /><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" /><path d="M12 11h4" /><path d="M12 16h4" /><path d="M8 11h.01" /><path d="M8 16h.01" /></svg>,
            AlertTriangle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z" /><line x1="12" x2="12" y1="9" y2="13" /><line x1="12" x2="12.01" y1="17" y2="17" /></svg>,
            Trash2: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 6h18" /><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" /><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" /><line x1="10" x2="10" y1="11" y2="17" /><line x1="14" x2="14" y1="11" y2="17" /></svg>,
            Calculator: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="16" height="20" x="4" y="2" rx="2" /><line x1="8" x2="16" y1="6" y2="6" /><line x1="16" x2="16" y1="14" y2="18" /><path d="M16 10h.01" /><path d="M12 10h.01" /><path d="M8 10h.01" /><path d="M12 14h.01" /><path d="M8 14h.01" /><path d="M12 18h.01" /><path d="M8 18h.01" /></svg>,
            FileText: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><line x1="16" x2="8" y1="13" y2="13" /><line x1="16" x2="8" y1="17" y2="17" /><line x1="10" x2="8" y1="9" y2="9" /></svg>,
            TrendingUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17" /><polyline points="16 7 22 7 22 13" /></svg>,
            BarChart3: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18" /><path d="M18 17V9" /><path d="M13 17V5" /><path d="M8 17v-3" /></svg>,
            BookOpen: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z" /><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" /></svg>,
            ArrowDownUp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 16 4 4 4-4" /><path d="M7 20V4" /><path d="m21 8-4-4-4 4" /><path d="M17 4v16" /></svg>,
            Calendar: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2" /><line x1="16" x2="16" y1="2" y2="6" /><line x1="8" x2="8" y1="2" y2="6" /><line x1="3" x2="21" y1="10" y2="10" /></svg>,
            Smartphone: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="14" height="20" x="5" y="2" rx="2" ry="2" /><line x1="12" x2="12" y1="18" y2="18" /></svg>,
            Map: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21" /><line x1="9" x2="9" y1="3" y2="18" /><line x1="15" x2="15" y1="6" y2="21" /></svg>,
            Zap: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" /></svg>,
            MessageCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z" /></svg>,
            ShieldCheck: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /><path d="m9 12 2 2 4-4" /></svg>,
            Timer: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="10" x2="14" y1="2" y2="2" /><line x1="12" x2="15" y1="14" y2="11" /><circle cx="12" cy="14" r="8" /></svg>,
            LineChart: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18" /><path d="m19 9-5 5-4-4-3 3" /></svg>,
            Megaphone: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 11 18-5v12L3 14v-3z" /><path d="M11.6 16.8a3 3 0 1 1-5.8-1.6" /></svg>,
            PiggyBank: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 5c-1.5 0-2.8 1.4-3 2-3.5-1.5-11-.3-11 5 0 1.8 0 3 2 4.5V20h4v-2h3v2h4v-4c1-.5 1.7-1 2-2h2v-4h-2c0-1-.5-1.5-1-2h0V5z" /><path d="M7 11h.01" /><path d="M11 7.5h4" /></svg>,
            Star: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" /></svg>,
            Scissors: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="6" cy="6" r="3" /><circle cx="6" cy="18" r="3" /><line x1="20" x2="8.12" y1="4" y2="15.88" /><line x1="14.47" x2="20" y1="14.48" y2="20" /><line x1="8.12" x2="12" y1="8.12" y2="12" /></svg>,
            Users: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></svg>,
            Trophy: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6" /><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18" /><path d="M4 22h16" /><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22" /><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22" /><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z" /></svg>,
            Target: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10" /><circle cx="12" cy="12" r="6" /><circle cx="12" cy="12" r="2" /></svg>,
            Shield: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /></svg>,
            Coins: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="8" cy="8" r="6" /><path d="M18.09 10.37A6 6 0 1 1 10.34 18" /><path d="M7 6h1v4" /><path d="m16.71 13.88.7.71-2.82 2.82" /></svg>,
            Layout: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2" /><line x1="3" x2="21" y1="9" y2="9" /><line x1="9" x2="9" y1="21" y2="9" /></svg>,
            // -- ICONOS INTERFAZ --
            Lock: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2" /><path d="M7 11V7a5 5 0 0 1 10 0v4" /></svg>,
            RotateCw: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8" /><path d="M21 3v5h-5" /></svg>,
            WhatsApp: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" /></svg>,
            CheckCircle: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" /><polyline points="22 4 12 14.01 9 11.01" /></svg>,
            ChevronLeft: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="15 18 9 12 15 6" /></svg>,
            ChevronRight: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="9 18 15 12 9 6" /></svg>,
        };

        // --- DATOS DEL CURSO ---
        const cardsData = [
            {
                "id": 1,
                "module": "MDULO 1",
                "stage": 1,
                "moduleTitle": "Separaci贸n Radical de Cuentas",
                "color": "bg-emerald-600",
                "lightColor": "bg-emerald-50",
                "textColor": "text-emerald-600",
                "icon": <Icons.Wallet />,
                "title": "Adi贸s al 'Bolso nico'",
                "frontText": "驴Cu谩nto de Monta帽a M铆a gastaste en el mercado hoy?",
                "backContent": {
                    "explanation": "Mezclar el dinero del negocio con los gastos del hogar (como uniformes o mercado) impide saber si Monta帽a M铆a es realmente rentable o solo una caja menor.",
                    "example": "Si usas el dinero de la venta de una espuma facial para pagar el transporte de las ni帽as, est谩s 'comi茅ndote' el capital para los pr贸ximos envases.",
                    "tip": "Usa una cuenta de Nequi exclusiva para el negocio y no toques un solo peso para gastos personales.",
                    "action": "Durante 3 d铆as, anota en tu cuaderno cada vez que uses dinero del negocio para algo de la casa. El total te sorprender谩.",
                    "resources_links": [{
                        "title": "Video: C贸mo separar tus finanzas",
                        "url": "https://www.youtube.com/watch?v=f9Q7s_x7_78"
                    }]
                }
            }
        ]

        function SEOFlashCards() {
            // Obtenemos los m贸dulos 煤nicos, pero NO a帽adimos "Todos" al principio
            const modules = useMemo(() => [...new Set(cardsData.map(c => c.module))], []);

            const [currentIndex, setCurrentIndex] = useState(0);
            const [isFlipped, setIsFlipped] = useState(false);
            const [filter, setFilter] = useState(modules[0]); // Iniciar en M贸dulo 1

            // ESTADO DE DESBLOQUEO (Inicia en 1)
            const [unlockedStage, setUnlockedStage] = useState(1);

            const [showUnlockModal, setShowUnlockModal] = useState(false);
            const [showFinalModal, setShowFinalModal] = useState(false);
            const [unlockCodeInput, setUnlockCodeInput] = useState("");
            const [unlockError, setUnlockError] = useState("");

            // Filtrado
            const filteredCards = filter === "Todos"
                ? cardsData
                : cardsData.filter(card => card.module === filter);

            const currentCard = filteredCards[currentIndex];

            // L贸gica de Bloqueo
            const isCardLocked = currentCard.stage > unlockedStage;

            // Manejador de Cambio de M贸dulo
            const handleFilterChange = (newFilter) => {
                const sampleCard = cardsData.find(c => c.module === newFilter);
                if (sampleCard && sampleCard.stage > unlockedStage) {
                    setShowUnlockModal(true);
                    return;
                }
                setFilter(newFilter);
                setCurrentIndex(0);
                setIsFlipped(false);
            };

            // Navegaci贸n Siguiente
            const nextCard = (e) => {
                // Detiene propagaci贸n para evitar conflictos con el giro de la tarjeta
                if (e) {
                    e.stopPropagation();
                    e.nativeEvent.stopImmediatePropagation();
                }

                // Si estamos en la 煤ltima tarjeta del filtro actual
                if (currentIndex === filteredCards.length - 1) {
                    // Modal final del curso
                    if (currentCard.backContent.unlockFinal) {
                        setShowFinalModal(true);
                        return;
                    }

                    // Si el filtro actual es "Todos" (ya no se usa pero por seguridad) o en un m贸dulo
                    // Verificar si el siguiente m贸dulo est谩 bloqueado
                    // En este caso, si estamos al final del m贸dulo y no es el final del curso, probablemente debamos
                    // cambiar de m贸dulo o mostrar el modal si el siguiente est谩 bloqueado.
                    // Pero como filtramos por m贸dulo, "filteredCards.length - 1" es el final del m贸dulo visualizado.

                    // L贸gica para avanzar al siguiente m贸dulo autom谩ticamente o mostrar modal
                    const currentModuleIndex = modules.indexOf(filter);
                    if (currentModuleIndex < modules.length - 1) {
                        const nextModule = modules[currentModuleIndex + 1];
                        const nextModuleSample = cardsData.find(c => c.module === nextModule);

                        if (nextModuleSample.stage > unlockedStage) {
                            setShowUnlockModal(true);
                            return;
                        } else {
                            // Si est谩 desbloqueado, cambiamos de filtro al siguiente m贸dulo
                            setFilter(nextModule);
                            setCurrentIndex(0);
                            setIsFlipped(false);
                            return;
                        }
                    }
                }

                // Voltea la tarjeta al frente para la transici贸n
                setIsFlipped(false);

                // Espera la mitad de la animaci贸n (250ms) para cambiar el contenido
                setTimeout(() => {
                    const nextIndex = (currentIndex + 1) % filteredCards.length;

                    // Doble verificaci贸n de seguridad
                    if (filteredCards[nextIndex].stage > unlockedStage) {
                        setShowUnlockModal(true);
                    } else {
                        setCurrentIndex(nextIndex);
                    }
                }, 250);
            };

            const prevCard = (e) => {
                if (e) e.stopPropagation();
                setIsFlipped(false);
                setTimeout(() => {
                    setCurrentIndex((prev) => (prev - 1 + filteredCards.length) % filteredCards.length);
                }, 250);
            };

            const handleFlip = () => {
                if (!isCardLocked) {
                    setIsFlipped(!isFlipped);
                } else {
                    setShowUnlockModal(true);
                }
            };

            const handleUnlockSubmit = (e) => {
                e.preventDefault();

                // CDIGOS ACTUALIZADOS
                const validCodes = {
                    1: "COSTOS_Y_REGISTROS", // Pasa a Nivel 2
                    2: "PROVEEDORES_Y_CAJA",   // Pasa a Nivel 3
                    3: "ANALISIS_Y_PLANIFICACION",        // Pasa a Nivel 4
                };

                const inputClean = unlockCodeInput.trim().toUpperCase();
                const expectedCode = validCodes[unlockedStage];

                if (inputClean === expectedCode) {
                    setUnlockedStage(prev => Math.min(prev + 1, 4));
                    setShowUnlockModal(false);
                    setUnlockCodeInput("");
                    setUnlockError("");
                } else {
                    setUnlockError("C贸digo incorrecto. P铆delo por WhatsApp.");
                }
            };

            const openWhatsApp = (msg) => {
                const phone = "573014619330";
                const url = `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
                window.open(url, '_blank');
            };

            return (
                <div className="min-h-screen bg-slate-50 flex flex-col font-sans text-slate-800">
                    {/* Header */}
                    <header className="bg-white border-b border-slate-200 sticky top-0 z-20 shadow-sm">
                        <div className="px-6 py-4 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 bg-slate-100 rounded-lg flex items-center justify-center overflow-hidden">
                                    <img src="Empii (1).png" alt="Empiiu Robot" className="w-full h-full object-cover" onError={(e) => { e.target.style.display = 'none'; e.target.parentElement.innerHTML = '' }} />
                                </div>
                                <div>
                                    <h1 className="text-lg font-bold tracking-tight text-slate-800 leading-none">Ruta Saneamiento y Estructura Financiera</h1>
                                    <p className="text-[10px] text-slate-400 uppercase tracking-widest mt-0.5">Monta帽aM铆a</p>
                                </div>
                            </div>
                            <div className="text-xs font-bold text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full border border-emerald-100">
                                Nivel {unlockedStage}/4
                            </div>
                        </div>
                    </header>

                    <main className="flex-1 max-w-5xl mx-auto w-full p-4 flex flex-col items-center justify-start gap-4 pb-12">

                        {/* Intro Box */}
                        <div className="bg-white p-5 rounded-2xl border border-slate-200 shadow-sm text-left relative overflow-hidden w-full max-w-3xl">
                            <div className="absolute top-0 left-0 w-1 h-full bg-emerald-500"></div>
                            <h2 className="text-lg font-bold text-slate-800 mb-2">Ruta de Aprendizaje y Accionables: Saneamiento y Estructura Financiera</h2>
                            <p className="text-slate-600 text-sm leading-relaxed mb-3">
                                Esta ruta pr谩ctica de 4 semanas est谩 dise帽ada para organizar las finanzas de tu negocio. Sin teor铆a infinita, solo acciones reales para <strong>Monta帽aM铆a</strong>.
                            </p>
                            <p className="text-xs text-slate-500 italic">
                                 Avanza con calma: 2 m贸dulos por semana. Haz los ejercicios.
                            </p>
                        </div>

                        {/* Module Filter - AJUSTADO: Ahora usa flex-wrap para verse completo en mobile */}
                        <div className="w-full py-1 flex flex-wrap justify-center gap-2 px-2">
                            {modules.map((mod) => {
                                const modSample = cardsData.find(c => c.module === mod);
                                const isLocked = modSample && modSample.stage > unlockedStage;

                                return (
                                    <button
                                        key={mod}
                                        onClick={() => handleFilterChange(mod)}
                                        className={`px-4 py-2 rounded-full text-xs font-bold uppercase tracking-wide transition-all whitespace-nowrap border flex items-center gap-2 mb-1 ${filter === mod
                                            ? "bg-slate-800 text-white border-slate-800 shadow-md"
                                            : isLocked
                                                ? "bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed"
                                                : "bg-white text-slate-500 border-slate-200 hover:bg-slate-50"
                                            }`}
                                    >
                                        {isLocked && <div className="w-3 h-3"><Icons.Lock /></div>}
                                        {mod.replace("MDULO ", "M")}
                                    </button>
                                );
                            })}
                        </div>

                        {/* Card Container: Fixed Size for All Cards */}
                        <div className="relative w-full max-w-2xl perspective-1000 group transition-all duration-300 ease-in-out">
                            {filteredCards.length > 0 ? (
                                <div
                                    onClick={handleFlip}
                                    className={`relative w-full duration-500 transform-style-3d cursor-pointer transition-all ${isFlipped ? "rotate-y-180" : ""
                                        }`}
                                >
                                    {/* FRENTE */}
                                    <div
                                        className={`w-full bg-white rounded-3xl shadow-xl border border-slate-200 flex flex-col backface-hidden overflow-visible transition-all duration-300 ease-in-out ${isFlipped ? "hidden" : ""}`}
                                    >
                                        {/* Overlay de Bloqueo Visual */}
                                        {isCardLocked && (
                                            <div className="absolute inset-0 bg-slate-100/95 backdrop-blur-sm z-10 flex flex-col items-center justify-center p-8">
                                                <div className="bg-white p-4 rounded-full shadow-lg mb-4 text-slate-400">
                                                    <Icons.Lock />
                                                </div>
                                                <h3 className="text-xl font-bold text-slate-700 mb-2">Contenido Bloqueado</h3>
                                                <p className="text-sm text-slate-500 mb-6">Debes completar los m贸dulos anteriores e ingresar tu c贸digo.</p>
                                                <button
                                                    onClick={(e) => { e.stopPropagation(); setShowUnlockModal(true); }}
                                                    className="bg-slate-800 text-white px-6 py-2 rounded-lg text-sm font-bold shadow-lg hover:bg-slate-700 transition-colors"
                                                >
                                                    Desbloquear Nivel
                                                </button>
                                            </div>
                                        )}

                                        <div className="w-full flex-1 flex flex-col items-center justify-center px-4 md:px-8 py-12 text-center">
                                            <div className={`mb-4 p-3 rounded-2xl shadow-sm ${currentCard.lightColor} ${currentCard.textColor}`}>
                                                {currentCard.icon}
                                            </div>
                                            <div className={`text-[10px] font-black uppercase tracking-widest mb-1 ${currentCard.textColor}`}>
                                                {currentCard.module}
                                            </div>
                                            <div className="text-xs font-medium text-slate-400 mb-2">
                                                {currentCard.moduleTitle}
                                            </div>
                                            <h3 className="text-xl md:text-2xl font-bold text-slate-800 mb-3 leading-tight">
                                                {currentCard.title}
                                            </h3>
                                            <p className="text-slate-600 text-base md:text-lg font-medium leading-relaxed max-w-md mx-auto">
                                                {currentCard.frontText}
                                            </p>
                                        </div>

                                        {/* Footer Frontal */}
                                        <div className="w-full p-4 border-t border-slate-50 flex items-center justify-center gap-2 text-slate-400 text-sm bg-white">
                                            <Icons.RotateCw />
                                            <span className="uppercase font-bold text-xs tracking-wide">Voltear tarjeta</span>
                                        </div>
                                    </div>

                                    {/* REVERSO */}
                                    <div
                                        className={`w-full bg-white rounded-3xl shadow-xl border border-slate-200 flex flex-col backface-hidden rotate-y-180 rounded-3xl transition-all duration-300 ease-in-out ${isFlipped ? "" : "hidden"}`}
                                    >
                                        {/* Header Absoluto Trasero */}
                                        <div className={`shrink-0 px-6 py-3 border-b border-slate-100 flex items-center gap-3 bg-white rounded-3xl ${currentCard.textColor}`}>
                                            <div className="scale-75 origin-left">{currentCard.icon}</div>
                                            <span className="font-bold text-xs uppercase tracking-wide truncate max-w-[300px]">{currentCard.title}</span>
                                        </div>

                                        {/* Contenido */}
                                        <div className="flex-1 p-5 md:p-8 space-y-3 md:space-y-5 text-left">
                                            {currentCard.backContent.explanation && (
                                                <div>
                                                    <h4 className="font-bold text-slate-900 text-sm mb-1 flex items-center gap-2">
                                                         Explicaci贸n
                                                    </h4>
                                                    <p className="text-slate-600 text-sm leading-relaxed">
                                                        {currentCard.backContent.explanation}
                                                    </p>
                                                </div>
                                            )}

                                            {currentCard.backContent.example && (
                                                <div className="pl-4 border-l-4 border-slate-200 py-1 bg-slate-50 p-3 rounded-r-lg">
                                                    <h4 className="font-bold text-slate-700 text-xs mb-1">EJEMPLO MONTAAMA</h4>
                                                    <p className="text-slate-500 text-sm italic">"{currentCard.backContent.example}"</p>
                                                </div>
                                            )}

                                            {currentCard.backContent.action && (
                                                <>
                                                    {currentCard.hasWhatsAppAction ? (
                                                        /* BOTN WHATSAPP SLIDO */
                                                        <button
                                                            onClick={(e) => {
                                                                e.stopPropagation();
                                                                openWhatsApp(`Hola, quiero el c贸digo para desbloquear el nivel: ${currentCard.backContent.action.replace("Solicita el c贸digo para ", "")}`);
                                                            }}
                                                            className="w-full flex gap-3 items-center bg-green-500 p-4 rounded-xl shadow-md hover:bg-green-600 transition-colors text-left group/btn text-white"
                                                        >
                                                            <div className="p-1">
                                                                <Icons.WhatsApp />
                                                            </div>
                                                            <div>
                                                                <span className="block text-xs font-bold text-green-100 uppercase mb-1">Tu Misi贸n: Pedir C贸digo</span>
                                                                <p className="text-sm font-bold text-white leading-tight">
                                                                    {currentCard.backContent.action}
                                                                </p>
                                                            </div>
                                                        </button>
                                                    ) : (
                                                        /* ACCIN NORMAL */
                                                        <div className="flex gap-3 items-start bg-emerald-50 p-4 rounded-xl border border-emerald-100 shadow-sm">
                                                            <div className="bg-emerald-100 p-1.5 rounded-full mt-0.5 shrink-0 text-emerald-700">
                                                                <Icons.CheckCircle />
                                                            </div>
                                                            <div>
                                                                <span className="block text-xs font-bold text-emerald-800 uppercase mb-1">Tu Misi贸n</span>
                                                                <p className="text-sm text-emerald-900 font-medium">
                                                                    {currentCard.backContent.action}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    )}
                                                </>
                                            )}

                                            {currentCard.backContent.tip && (
                                                <div className="text-xs text-slate-500 bg-slate-100 p-3 rounded-lg flex gap-2">
                                                    <span>锔</span>
                                                    <span className="font-semibold text-slate-600">Tip Pro: {currentCard.backContent.tip}</span>
                                                </div>
                                            )}

                                            {currentCard.backContent.resources_links && currentCard.backContent.resources_links.length > 0 && (
                                                <div>
                                                    <h4 className="font-bold text-slate-900 text-sm mb-2 flex items-center gap-2">
                                                         Resources
                                                    </h4>
                                                    <div className="space-y-2">
                                                        {currentCard.backContent.resources_links.map((resource, idx) => (
                                                            <a
                                                                key={idx}
                                                                href={resource.url}
                                                                target="_blank"
                                                                rel="noopener noreferrer"
                                                                onClick={(e) => e.stopPropagation()}
                                                                className="card-link block text-sm p-3 bg-blue-50 border border-blue-100 rounded-lg hover:bg-blue-100 transition-colors"
                                                            >
                                                                {resource.title}
                                                            </a>
                                                        ))}
                                                    </div>
                                                </div>
                                            )}
                                        </div>

                                        {/* Footer Trasero */}
                                        <div className="w-full p-4 flex justify-between items-center bg-white border-t border-slate-100 text-slate-400 text-xs">
                                            <span>{currentCard.module}</span>
                                            <button
                                                onClick={(e) => {
                                                    e.stopPropagation();
                                                    setIsFlipped(false);
                                                }}
                                                className="flex items-center gap-1 font-bold text-slate-600 hover:text-emerald-600 transition-colors z-30 relative px-4 py-2 rounded-lg hover:bg-slate-50"
                                            >
                                                Voltear <Icons.RotateCw />
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div className="w-full h-full flex items-center justify-center bg-white rounded-3xl border-2 border-dashed border-slate-300">
                                    <p className="text-slate-400 font-medium">Selecciona un m贸dulo para empezar.</p>
                                </div>
                            )}
                        </div>

                        {/* Controles Externos */}
                        <div className="flex items-center justify-center gap-6 mt-6 mb-8">
                            <button onClick={prevCard} className="p-4 rounded-full bg-white border border-slate-200 shadow-sm text-slate-500 active:scale-95 transition-all"><Icons.ChevronLeft /></button>
                            <div className="text-sm font-bold text-slate-400 tracking-widest">{currentIndex + 1} / {filteredCards.length}</div>
                            <button onClick={(e) => nextCard(null)} className="p-4 rounded-full bg-slate-800 shadow-lg text-white active:scale-95 transition-all"><Icons.ChevronRight /></button>
                        </div>

                        {/* === MODAL DESBLOQUEO DE NIVEL === */}
                        {showUnlockModal && (
                            <div className="fixed inset-0 bg-slate-900/80 backdrop-blur-sm z-50 flex items-center justify-center p-4">
                                <div className="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-bounce-short" style={{ animation: 'none' }}>
                                    <div className="flex justify-between items-start mb-4">
                                        <div className="bg-amber-100 p-2 rounded-full text-amber-600"><Icons.Lock /></div>
                                        <button onClick={() => setShowUnlockModal(false)} className="text-slate-400 hover:text-slate-600 text-xl font-bold">&times;</button>
                                    </div>
                                    <h3 className="text-xl font-bold text-slate-800 mb-2">Siguiente Nivel Bloqueado</h3>
                                    <p className="text-slate-600 text-sm mb-6">
                                        Para acceder a los m贸dulos {unlockedStage * 2 + 1} y {unlockedStage * 2 + 2}, necesitas el c贸digo de acceso.
                                    </p>

                                    <button
                                        onClick={() => openWhatsApp("Hola, ya termin茅 los m贸dulos de la Ruta Saneamiento y Estructura Financiera y quiero desbloquear el siguiente nivel.")}
                                        className="w-full flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold text-sm py-3 rounded-xl mb-6 transition-colors shadow-green-200 shadow-lg"
                                    >
                                        <Icons.WhatsApp />
                                        <span>Pedir c贸digo por WhatsApp</span>
                                    </button>

                                    <form onSubmit={handleUnlockSubmit} className="border-t border-slate-100 pt-4">
                                        <p className="text-xs text-center text-slate-400 uppercase font-bold mb-2">Ingresar Contrase帽a</p>
                                        <input
                                            type="text"
                                            value={unlockCodeInput}
                                            onChange={(e) => setUnlockCodeInput(e.target.value.toUpperCase())}
                                            placeholder="CDIGO"
                                            className="w-full px-4 py-3 rounded-xl border border-slate-200 focus:border-slate-800 focus:ring-2 focus:ring-slate-100 outline-none text-center font-mono uppercase tracking-widest text-lg mb-2"
                                        />
                                        {unlockError && <p className="text-red-500 text-xs text-center mb-2">{unlockError}</p>}
                                        <button
                                            type="submit"
                                            className="w-full bg-slate-800 hover:bg-slate-700 text-white font-bold py-3 rounded-xl transition-colors"
                                        >
                                            Desbloquear
                                        </button>
                                    </form>
                                </div>
                            </div>
                        )}

                        {/* === MODAL FINAL OBLIGATORIO === */}
                        {showFinalModal && (
                            <div className="fixed inset-0 bg-slate-900/90 backdrop-blur-md z-[60] flex items-center justify-center p-4">
                                <div className="bg-white rounded-3xl shadow-2xl max-w-sm w-full p-8 text-center relative overflow-hidden">
                                    <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-emerald-400 to-blue-500"></div>
                                    <div className="bg-emerald-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-6 text-emerald-600">
                                        <Icons.CheckCircle />
                                    </div>
                                    <h2 className="text-2xl font-black text-slate-800 mb-2">隆Ruta Completada!</h2>
                                    <p className="text-slate-600 mb-8">
                                        Has terminado los 8 m贸dulos. Ahora necesitamos revisar tus avances en rinconesyveredas.com y definir los siguientes pasos.
                                    </p>

                                    <button
                                        onClick={() => openWhatsApp("Hola, ya termin茅 la ruta Saneamiento y Estructura Financiera completa y quiero revisar resultados y siguientes pasos.")}
                                        className="w-full flex items-center justify-center gap-2 bg-green-500 hover:bg-green-600 text-white font-bold py-4 rounded-xl shadow-xl shadow-green-200 transition-all hover:scale-105"
                                    >
                                        <Icons.WhatsApp />
                                        <span>Contactar para Revisi贸n Final</span>
                                    </button>
                                    <p className="text-[10px] text-slate-400 mt-4">No hay contenido posterior sin esta validaci贸n.</p>
                                </div>
                            </div>
                        )}

                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SEOFlashCards />);
    </script>
</body>

</html>